<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Adaptive DNS Resolver Discovery</title>
<meta content="Tommy Pauly" name="author">
<meta content="Eric Kinnear" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="Patrick McManus" name="author">
<meta content="
       This document defines a method for dynamically discovering resolvers that support
encrypted transports, and introduces the concept of a designating a resolver
to be used for a subset of client queries based on domain. This method is intended
to work both for locally-hosted resolvers and resolvers accessible over the broader
Internet. 
    " name="description">
<meta content="xml2rfc 2.39.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-pauly-add-resolver-discovery-latest" name="ietf.draft">
<link href="draft-pauly-add-resolver-discovery.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 1em;
  border-top: 1px solid var(--line-color);
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ADNS Discovery</td>
<td class="right">May 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pauly, et al.</td>
<td class="center">Expires 6 November 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-pauly-add-resolver-discovery-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-05-05" class="published">5 May 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-11-06">6 November 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Pauly</div>
<div class="org">Apple Inc.</div>
</div>
<div class="author">
      <div class="author-name">E. Kinnear</div>
<div class="org">Apple Inc.</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">P. McManus</div>
<div class="org">Fastly</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Adaptive DNS Resolver Discovery</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a method for dynamically discovering resolvers that support
encrypted transports, and introduces the concept of a designating a resolver
to be used for a subset of client queries based on domain. This method is intended
to work both for locally-hosted resolvers and resolvers accessible over the broader
Internet.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 November 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-specification-of-requiremen" class="xref">Specification of Requirements</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-designated-resolvers" class="xref">Designated Resolvers</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-discovering-designated-doh-" class="xref">Discovering Designated DoH Resolvers</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-explicit-discovery-of-local" class="xref">Explicit Discovery of Local Resolvers</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-discovery-of-doh-capabiliti" class="xref">Discovery of DoH Capabilities for Direct Resolvers</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-server-deployment-considera" class="xref">Server Deployment Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-single-content-provider" class="xref">Single Content Provider</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-multiple-content-providers" class="xref">Multiple Content Providers</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-avoid-narrow-deployments" class="xref">Avoid Narrow Deployments</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-local-resolver-deployment-c" class="xref">Local Resolver Deployment Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-designating-local-doh-serve" class="xref">Designating Local DoH Servers</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-local-use-cases" class="xref">Local Use Cases</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="xref">8.2.1</a>.  <a href="#name-accessing-local-only-resolv" class="xref">Accessing Local-Only Resolvable Content</a><a href="#section-toc.1-1.8.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="xref">8.2.2</a>.  <a href="#name-accessing-locally-optimized" class="xref">Accessing Locally Optimized Content</a><a href="#section-toc.1-1.8.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="xref">8.2.3</a>.  <a href="#name-walled-garden-and-captive-n" class="xref">Walled-Garden and Captive Network Deployments</a><a href="#section-toc.1-1.8.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="xref">8.2.4</a>.  <a href="#name-network-based-filtering" class="xref">Network-Based Filtering</a><a href="#section-toc.1-1.8.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-doh-template-pvd-key" class="xref">DoH Template PvD Key</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-dns-filtering-pvd-keys" class="xref">DNS Filtering PvD Keys</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-doh-uri-template-dns-parame" class="xref">DoH URI Template DNS Parameter</a><a href="#section-toc.1-1.11.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.13.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">When clients need to resolve names into addresses in order to establish networking connections,
they traditionally use by default the DNS resolver that is provisioned
by the local network along with their IP address <span>[<a href="#RFC2132" class="xref">RFC2132</a>]</span> <span>[<a href="#RFC8106" class="xref">RFC8106</a>]</span>. Alternatively, they
can use a resolver indicated by a tunneling service such as a VPN.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">However, privacy-sensitive clients might prefer to use an encrypted DNS service other
than the one locally provisioned in order to prevent interception,
profiling, or modification by entities other than the operator of the
name service for the name being resolved. Protocols that can improve the transport security
of a client when using DNS or creating TLS connections include DNS-over-TLS <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>,
DNS-over-HTTPS <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>, and encrypted Server Name Indication (ESNI) <span>[<a href="#I-D.ietf-tls-esni" class="xref">I-D.ietf-tls-esni</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document defines a method for dynamically discovering resolvers that support
encrypted transports, and introduces the concept of a designating a resolver
to be used for a subset of client queries based on domain. This method is intended
to work both for locally-hosted resolvers and resolvers accessible over the broader
Internet.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="specification-of-requirements">
<section id="section-1.1">
        <h3 id="name-specification-of-requiremen">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-specification-of-requiremen" class="section-name selfRef">Specification of Requirements</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP 14
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when,
they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">This document defines the following terms:<a href="#section-2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">Designated Resolver:</dt>
<dd id="section-2-2.2">
  A DNS resolver that is designated as a responsible resolver for a given domain or zone.<a href="#section-2-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-2-2.3">Direct Resolver:</dt>
<dd id="section-2-2.4">
  A DNS resolver using any transport that is provisioned directly by a local router or a VPN.<a href="#section-2-2.4" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<div id="designated-resolvers">
<section id="section-3">
      <h2 id="name-designated-resolvers">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-designated-resolvers" class="section-name selfRef">Designated Resolvers</a>
      </h2>
<ul>
<li id="section-3-1.1">Based on DNSSEC-signed SVCB record<a href="#section-3-1.1" class="pilcrow">¶</a>
</li>
<li id="section-3-1.2">Based on confirmation of a trusted domain, listed in additional information<a href="#section-3-1.2" class="pilcrow">¶</a>
</li>
<li id="section-3-1.3">Use IP hints for addresses<a href="#section-3-1.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="discovering-designated-doh-resolvers">
<section id="section-4">
      <h2 id="name-discovering-designated-doh-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-discovering-designated-doh-" class="section-name selfRef">Discovering Designated DoH Resolvers</a>
      </h2>
<p id="section-4-1">Clients dynamically build and maintain a set of known Designated DoH Servers. The information
that is associated with each server is:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.1">The URI Template of the DoH server <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span><a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4-2.2">A list of domains for which the DoH server is designated<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4-3">This information can be retrieved from several different sources. The primary source
for discovering Designated DoH Server configurations is from properties stored in a
SVCB (or a SVCB-conformant type like HTTPSSVC) DNS Record <span>[<a href="#I-D.nygren-dnsop-svcb-httpssvc" class="xref">I-D.nygren-dnsop-svcb-httpssvc</a>]</span>.
This record provides the URI Template of a DoH server that is designated for a specific domain.
A specific domain may have more than one such record.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">In order to designate a DoH server for a domain, a SVCB record can
contain the "dohuri" (<a href="#iana" class="xref">Section 11</a>). The value stored in the parameter
is a URI, which is the DoH URI template <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The following example shows a record containing a DoH URI, as returned by a query for
the HTTPSSVC variant of the SVCB record type on "example.com".<a href="#section-4-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-6">
<pre>
   example.com.      7200  IN HTTPSSVC 0 svc.example.net.
   svc.example.net.  7200  IN HTTPSSVC 2 svc1.example.net. (
                                                                           dohuri=https://doh.example.net/dns-query
                                                                           odohkey="..." )
</pre><a href="#section-4-6" class="pilcrow">¶</a>
</div>
<p id="section-4-7">Clients SHOULD NOT accept designations for effective top-level domains (eTLDs), such
as ".com".<a href="#section-4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local-discovery">
<section id="section-5">
      <h2 id="name-explicit-discovery-of-local">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-explicit-discovery-of-local" class="section-name selfRef">Explicit Discovery of Local Resolvers</a>
      </h2>
<p id="section-5-1">If the local network provides configuration with an Explicit Provisioning Domain (PvD), as
defined by <span>[<a href="#I-D.ietf-intarea-provisioning-domains" class="xref">I-D.ietf-intarea-provisioning-domains</a>]</span>, clients can learn about domains
for which the local network's resolver is authoritative.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If an RA provided by the router on the network defines an Explicit PvD that has additional
information, and this additional information JSON dictionary contains the key "dohTemplate" (<a href="#iana" class="xref">Section 11</a>),
then the client SHOULD add this DoH server to its list of known DoH configurations. The
domains that the DoH server claims authority for are listed in the "dnsZones" key. Clients
MUST use an SVCB record from the locally-provisioned DoH server and validate
the answer with DNSSEC <span>[<a href="#RFC4033" class="xref">RFC4033</a>]</span> before creating a mapping from the domain to the server.
Once this has been validated, clients can use this server for resolution as described in
step 2.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">See <a href="#local-deployment" class="xref">Section 8</a> for local deployment considerations.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovery-of-doh-capabilities-for-direct-resolvers">
<section id="section-6">
      <h2 id="name-discovery-of-doh-capabiliti">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-discovery-of-doh-capabiliti" class="section-name selfRef">Discovery of DoH Capabilities for Direct Resolvers</a>
      </h2>
<ul>
<li id="section-6-1.1">Companion DoH server<a href="#section-6-1.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="server-deployment-considerations">
<section id="section-7">
      <h2 id="name-server-deployment-considera">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-server-deployment-considera" class="section-name selfRef">Server Deployment Considerations</a>
      </h2>
<p id="section-7-1">When servers designate DoH servers for their names, the specific deployment
model can impact the effective privacy and performance characteristics.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="single-content-provider">
<section id="section-7.1">
        <h3 id="name-single-content-provider">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-single-content-provider" class="section-name selfRef">Single Content Provider</a>
        </h3>
<p id="section-7.1-1">If a name always resolves to server IP addresses that are hosted by a single
content provider, the name ought to designate a single DoH server. This
DoH server will be most optimal when it is designated by many or all names
that are hosted by the same content provider. This ensures that clients
can increase connection reuse to reduce latency in connection setup.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">A DoH server that corresponds to the content provider that hosts content has an
opportunity to tune the responses provided to a client based on the location
inferred by the client IP address.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-content-providers">
<section id="section-7.2">
        <h3 id="name-multiple-content-providers">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-multiple-content-providers" class="section-name selfRef">Multiple Content Providers</a>
        </h3>
<p id="section-7.2-1">Some hostnames may resolve to server IP addresses that are hosted by multiple
content providers. In such scenarios, the deployment may want to be able to
control the percentage of traffic that flows to each content provider.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">In these scenarios, there can either be:<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.2-3.1">multiple designated DoH servers that are advertised via SVCB DNS Records; or,<a href="#section-7.2-3.1" class="pilcrow">¶</a>
</li>
<li id="section-7.2-3.2">a single designated DoH server that can be referenced by one or more SVCB DNS Records,
operated by a party that is aware of both content providers and can manage
splitting the traffic.<a href="#section-7.2-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.2-4">If a server deployment wants to easily control the split of traffic between different
content providers, it ought to use the latter model of using a single designated DoH server
that can better control which IP addresses are provided to clients. Otherwise, if a
client is aware of multiple DoH servers, it might use a single resolver exclusively,
which may lead to inconsistent behavior between clients that choose different resolvers.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="avoid-narrow-deployments">
<section id="section-7.3">
        <h3 id="name-avoid-narrow-deployments">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-avoid-narrow-deployments" class="section-name selfRef">Avoid Narrow Deployments</a>
        </h3>
<p id="section-7.3-1">Using designated DoH servers can improve the privacy of name resolution whenever
a DoH server is designated by many different names within one or more domains.
This limits the amount of information leaked to an attacker observing traffic between a
client and a DoH server: the attacker only learns that the client might be resolving
one of the many names for which the server is designated.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">However, if a deployment designates a given DoH server for only one name, or a
very small set of names, then it becomes easier for an attacker to infer that a specific
name is being accessed by a client. For this reason, deployments are encouraged
to avoid deploying a DoH server that is only designated by a small number of names.
Clients can also choose to only whitelist DoH servers that are associated with
many names.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Beyond the benefits to privacy, having a larger number of names designate
a given DoH server improves the opportunity for DoH connection reuse, which
can improve the performance of name resolutions.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="local-deployment">
<section id="section-8">
      <h2 id="name-local-resolver-deployment-c">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-local-resolver-deployment-c" class="section-name selfRef">Local Resolver Deployment Considerations</a>
      </h2>
<p id="section-8-1">A key goal of Adaptive DNS is that clients will be able to use Designated DoH Servers
to improve the privacy of queries, without entirely bypassing local network authority and
policy. For example, if a client is attached to an enterprise Wi-Fi network that provides
access and resolution for private names not generally accessible on the Internet, such
names will only be usable when a local resolver is used.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">In order to achieve this, a local network can advertise itself as authoritative for a domain,
allowing it to be used prior to external servers in the client resolution algorithm.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="designating-local-servers">
<section id="section-8.1">
        <h3 id="name-designating-local-doh-serve">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-designating-local-doh-serve" class="section-name selfRef">Designating Local DoH Servers</a>
        </h3>
<p id="section-8.1-1">If a local network wants to have clients send queries for a set of private domains to its own resolver,
it needs to define an explicit provisioning domain <span>[<a href="#I-D.ietf-intarea-provisioning-domains" class="xref">I-D.ietf-intarea-provisioning-domains</a>]</span>.
The PvD RA option SHOULD set the H-flag to indicate that Additional Information is available.
This Additional Information JSON object SHOULD include both the "dohTemplate" and "dnsZones"
keys to define the local DoH server and the domains over which it claims authority.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">In order to validate that a local resolver is designated for a given zone, the client SHOULD issue
a SVCB record query for the names specified in the PvD information, using the DoH server specified
in the PvD information. If there is no SVCB record for a name that points to the DoH server that can be validated
using DNSSEC, the client SHOULD NOT automatically create a designation from the domain name to DoH server.
See specific use cases in <a href="#local-use-cases" class="xref">Section 8.2</a> for cases in which a local resolver may still be used.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local-use-cases">
<section id="section-8.2">
        <h3 id="name-local-use-cases">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-local-use-cases" class="section-name selfRef">Local Use Cases</a>
        </h3>
<p id="section-8.2-1">The various use cases for selecting locally-provisioned resolvers require different approaches for
deployment and client resolution. The following list is not exhaustive, but provides guidance on how
these scenarios can be achieved using the Adaptive DNS algorithm.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div id="accessing-local-only-resolvable-content">
<section id="section-8.2.1">
          <h4 id="name-accessing-local-only-resolv">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-accessing-local-only-resolv" class="section-name selfRef">Accessing Local-Only Resolvable Content</a>
          </h4>
<p id="section-8.2.1-1">Some names are not resolvable using generic DNS resolvers, but require using a DNS server that can
resolve private names. This is common in enterprise scenarios, in which an enterprise can have
a set of private names that it allows to be resolved when connected to a VPN or an enterprise-managed
Wi-Fi network. In this case, clients that do not use the locally-provisioned resolver will fail to resolve
private names.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">In these scenarios, the local network SHOULD designate a local DoH server for the domains that are
locally resolvable. For example, an enterprise that owns "private.example.org" would advertise
"private.example.org" in its PvD information along with a DoH URI template. Clients could then
use that locally-configured resolver with names under "private.example.org" according to the rules in <a href="#designating-local-servers" class="xref">Section 8.1</a>.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1-3">In general, clients SHOULD only create designated DoH server associations when they can validate a SVCB
record using DNSSEC. However, some deployments of private names might not want to sign all
private names within a zone. There are thus a few possible deployment models:<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.2.1-4.1">"private.example.org" does have a DNSSEC-signed SVCB record that points to the local DoH server.
The client requests the SVCB record for "private.example.org" using the local DoH server that is
specified in the PvD information, and from that point on uses the local DoH server for names under
"private.example.org".<a href="#section-8.2.1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-8.2.1-4.2">Instead of signing "private.example.org", the deployment provides a DNSSEC-signed SVCB record
for "example.org", thus steering all resolution under "example.org" to the local resolver.<a href="#section-8.2.1-4.2" class="pilcrow">¶</a>
</li>
<li id="section-8.2.1-4.3">No DNSSEC-signed SVCB record designates the local server. In this case, clients have a hint that
the local network can serve names under "private.example.org", but do not have a way to validate
the designation. Clients can in this case try to resolve names using external servers (such
as via Oblivious DoH), and then MAY fall back to using locally-provisioned resolvers if the names do not
resolve externally. This approach has the risk of exposing private names to public resolvers,
which can be undesirable for certain enterprise deployments. Alternatively, if the client trusts
the local network based on specific policy configured on the client, it can choose to resolve these names
locally first. Note that this approach risks exposing names to a potentially malicious network that is
masquerading as an authority for private names if the network cannot be validated in some other manner.<a href="#section-8.2.1-4.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-8.2.1-5">Deployments SHOULD use the one of the first two approaches (signing their records) whenever possible;
the case of providing unsigned names is only described as a possibility for handling legacy enterprise
deployments. Clients SHOULD choose to ignore any locally designated names that are not
signed unless there is a specific policy configuration on the client.<a href="#section-8.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accessing-locally-optimized-content">
<section id="section-8.2.2">
          <h4 id="name-accessing-locally-optimized">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-accessing-locally-optimized" class="section-name selfRef">Accessing Locally Optimized Content</a>
          </h4>
<p id="section-8.2.2-1">Other names may be resolvable both publicly and on the local resolver, but have more optimized
servers that are accessible only via the local network. For example, a Wi-Fi provider may provide
access to a cache of video content that provides lower latency than publicly-accessible caches.<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">Names that are hosted locally in this way SHOULD use a designation with a DNSSEC-signed SVCB
record for the name. If a client discovers that a local resolver is designated for a given name, the
client SHOULD prefer using connections to this locally-hosted content rather than names resolved
externally.<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2.2-3">Note that having a DNSSEC-signed designation to the local resolver provides a clear indication
that the entity that manages a given name has an explicit relationship with the local network provider.<a href="#section-8.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="captive">
<section id="section-8.2.3">
          <h4 id="name-walled-garden-and-captive-n">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-walled-garden-and-captive-n" class="section-name selfRef">Walled-Garden and Captive Network Deployments</a>
          </h4>
<p id="section-8.2.3-1">Some networks do not provide any access to the general Internet, but host local content that
clients can access. For example, a network on an airplane can give access to flight information
and in-flight media, but will not allow access to any external hosts or DNS servers. These
networks are often described as "walled-gardens".<a href="#section-8.2.3-1" class="pilcrow">¶</a></p>
<p id="section-8.2.3-2">Captive networks <span>[<a href="#I-D.ietf-capport-architecture" class="xref">I-D.ietf-capport-architecture</a>]</span> are similar in that they block access to
external hosts, although they can provide generic access after some time.<a href="#section-8.2.3-2" class="pilcrow">¶</a></p>
<p id="section-8.2.3-3">If a walled-garden or captive network defines a PvD with additional information, it can
define zones for names that it hosts, such as "airplane.example.com". It can also provide a
locally-hosted encrypted DNS server.<a href="#section-8.2.3-3" class="pilcrow">¶</a></p>
<p id="section-8.2.3-4">However, if such a network does not support explicitly advertising local names,
clients that try to establish connections to DoH servers will experience connection failures.
In these cases, system traffic that is used for connecting to captive portals SHOULD
use local resolvers. In addition, clients MAY choose to fall back to using direct
resolution without any encryption if they determine that all connectivity is blocked otherwise.
Note that this comes with a risk of a network blocking connections in order to induce this
fallback behavior, so clients might want to inform users about this possible attack where
appropriate, or prefer to not fall back if there is a concern about leaking user data.<a href="#section-8.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="network-based-filtering">
<section id="section-8.2.4">
          <h4 id="name-network-based-filtering">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-network-based-filtering" class="section-name selfRef">Network-Based Filtering</a>
          </h4>
<p id="section-8.2.4-1">Some networks currently rely on manipulating DNS name resolution in order to apply
content filtering rules to clients associated with the network. Using encrypted DNS resolvers
that are not participating in this filtering can bypass such enforcement. However, simply
blocking connections for filtering is indistinguishable from a malicious attack from
a client's perspective.<a href="#section-8.2.4-1" class="pilcrow">¶</a></p>
<p id="section-8.2.4-2">In order to indicate the presence of filtering requirements, a network deployment
can add the "requireDNSFiltering" and "dnsFilteredZones" keys to its PvD information.
The "dnsFilteredZones" entry can contain an array of strings, each of which is a domain
name that the network requires clients to resolve using the local resolver. If the array contains
the string ".", it indicates the network requires filtering for all domains. If "requireDNSFiltering"
is present with a boolean value of true, the network is indicating that it expects all client systems
to send the names indicated by "dnsFilteredZones" to the local resolver. If "requireDNSFiltering"
is not present or set to false, then the filtering service is considered to be optional for clients
that want to use it as a service to enforce desired policy.<a href="#section-8.2.4-2" class="pilcrow">¶</a></p>
<p id="section-8.2.4-3">Clients that receive indication of filtering requirements SHOULD NOT use any other
resolver for the filtered domains, but treat the network as claiming authority. However,
since this filtering cannot be authenticated, this behavior SHOULD NOT be done
silently without user consent.<a href="#section-8.2.4-3" class="pilcrow">¶</a></p>
<p id="section-8.2.4-4">Networks that try to interfere with connections to encrypted DNS resolvers without
indicating a requirement for filtering cannot be distinguished from misconfigurations
or network attacks. Clients MAY choose to avoid sending any user-initiated connections
on such networks to prevent malicious interception.<a href="#section-8.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">In order to avoid interception and modification of the information retrieved by clients
using Adaptive DNS, all exchanges between clients and servers are performed over encrypted
connections, e.g., TLS.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Malicious adversaries may block client connections to a DoH service as a
Denial-of-Service (DoS) measure. Clients which cannot connect to any proxy may, by local
policy, fall back to unencrypted DNS if this occurs.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-10-1">Clients must be careful in determining to which DoH servers they send queries
directly without proxying. A malicious DoH server that can direct queries to itself
can track or profile client activity. In order to avoid the possibility of a spoofed SVCB
record designating a malicious DoH server for a name, clients MUST ensure that
such records validate using DNSSEC <span>[<a href="#RFC4033" class="xref">RFC4033</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Even servers that are officially designated can risk leaking or logging information
about client lookups. Such risk can be mitigated by further restricting the list of
DoH servers that are whitelisted for direct use based on client policy.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">An adversary able to see traffic on each path segment of a DoH query (e.g., from client to
proxy, proxy to target, and target to an authoritative DNS server) can link queries to specific
clients with high probability. Failure to observe traffic on any one of these path segments
makes this linkability increasingly difficult. For example, if an adversary can only
observe traffic between a client and proxy and egress traffic from a target, then it may
be difficult identify a specific client's query among the recursive queries generated by the target.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="doh-template-pvd-key">
<section id="section-11.1">
        <h3 id="name-doh-template-pvd-key">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-doh-template-pvd-key" class="section-name selfRef">DoH Template PvD Key</a>
        </h3>
<p id="section-11.1-1">This document adds a key to the "Additional Information PvD Keys" registry <span>[<a href="#I-D.ietf-intarea-provisioning-domains" class="xref">I-D.ietf-intarea-provisioning-domains</a>]</span>.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">JSON key</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dohTemplate</td>
              <td class="text-left" rowspan="1" colspan="1">DoH URI Template <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">"https://dnsserver.example.net/dns-query{?dns}"</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="dns-filtering-pvd-keys">
<section id="section-11.2">
        <h3 id="name-dns-filtering-pvd-keys">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-dns-filtering-pvd-keys" class="section-name selfRef">DNS Filtering PvD Keys</a>
        </h3>
<p id="section-11.2-1">This document adds a key to the "Additional Information PvD Keys" registry <span>[<a href="#I-D.ietf-intarea-provisioning-domains" class="xref">I-D.ietf-intarea-provisioning-domains</a>]</span>.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">JSON key</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">requireDNSFiltering</td>
              <td class="text-left" rowspan="1" colspan="1">A flag to indicate that the network requires filtering all DNS traffic using the provisioned resolver.</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">true</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dnsFilteredZones</td>
              <td class="text-left" rowspan="1" colspan="1">A list of DNS domains as strings that represent domains that can be filtered by the provisioned resolver.</td>
              <td class="text-left" rowspan="1" colspan="1">Array of Strings</td>
              <td class="text-left" rowspan="1" colspan="1">[ "." ]</td>
            </tr>
          </tbody>
        </table>
<p id="section-11.2-3">Any network that sets the "requireDNSFiltering" boolean to false but provides "dnsFilteredZones" advertises the optional
service of filtering on the provisioned network.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">An "." in the "dnsFilteredZones" array represents a wildcard, which can be used to indicate that the network is requesting
to filter all names. Any more specific string represents a domain that requires filtering on the network.<a href="#section-11.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="doh-uri-template-dns-parameter">
<section id="section-11.3">
        <h3 id="name-doh-uri-template-dns-parame">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-doh-uri-template-dns-parame" class="section-name selfRef">DoH URI Template DNS Parameter</a>
        </h3>
<p id="section-11.3-1">If present, this parameters indicates the URI template of a DoH server that is designated
for use with the name being resolved. This is a string encoded as UTF-8 characters.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-11.3-2">
          <dt id="section-11.3-2.1">Name:</dt>
<dd id="section-11.3-2.2">
  dohuri<a href="#section-11.3-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-11.3-2.3">SvcParamKey:</dt>
<dd id="section-11.3-2.4">
  TBD<a href="#section-11.3-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-11.3-2.5">Meaning:</dt>
<dd id="section-11.3-2.6">
  URI template for a designated DoH server<a href="#section-11.3-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-11.3-2.7">Reference:</dt>
<dd id="section-11.3-2.8">
  This document.<a href="#section-11.3-2.8" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-12">
      <h2 id="name-acknowledgments">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-12-1">Thanks to Erik Nygren, Lorenzo Colitti, Tommy Jensen, Mikael Abrahamsson,
Ben Schwartz, Ask Hansen, Leif Hedstrom, Tim McCoy, Stuart Cheshire, Miguel Vega,
Joey Deng, Ted Lemon, and Elliot Briggs for their feedback and input on this document.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-intarea-provisioning-domains">[I-D.ietf-intarea-provisioning-domains]</dt>
<dd>
<span class="refAuthor">Pfister, P.</span><span class="refAuthor">, Vyncke, E.</span><span class="refAuthor">, Pauly, T.</span><span class="refAuthor">, Schinazi, D.</span><span class="refAuthor">, and W. Shao</span>, <span class="refTitle">"Discovering Provisioning Domain Names and Data"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-intarea-provisioning-domains-11</span>, <time datetime="2020-01-31">31 January 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-intarea-provisioning-domains-11.txt">http://www.ietf.org/internet-drafts/draft-ietf-intarea-provisioning-domains-11.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-tls-esni">[I-D.ietf-tls-esni]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Oku, K.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"Encrypted Server Name Indication for TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-06</span>, <time datetime="2020-03-09">9 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-06.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-06.txt</a>&gt;</span>. </dd>
<dt id="I-D.nygren-dnsop-svcb-httpssvc">[I-D.nygren-dnsop-svcb-httpssvc]</dt>
<dd>
<span class="refAuthor">Schwartz, B.</span><span class="refAuthor">, Bishop, M.</span><span class="refAuthor">, and E. Nygren</span>, <span class="refTitle">"Service binding and parameter specification via the DNS (DNS SVCB and HTTPSSVC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-nygren-dnsop-svcb-httpssvc-00</span>, <time datetime="2019-09-23">23 September 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-nygren-dnsop-svcb-httpssvc-00.txt">http://www.ietf.org/internet-drafts/draft-nygren-dnsop-svcb-httpssvc-00.txt</a>&gt;</span>. </dd>
<dt id="RFC4033">[RFC4033]</dt>
<dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dt id="RFC7858">[RFC7858]</dt>
<dd>
<span class="refAuthor">Hu, Z.</span><span class="refAuthor">, Zhu, L.</span><span class="refAuthor">, Heidemann, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, Wessels, D.</span><span class="refAuthor">, and P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dt id="RFC8484">[RFC8484]</dt>
<dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-capport-architecture">[I-D.ietf-capport-architecture]</dt>
<dd>
<span class="refAuthor">Larose, K.</span><span class="refAuthor">, Dolson, D.</span><span class="refAuthor">, and H. Liu</span>, <span class="refTitle">"CAPPORT Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-capport-architecture-07</span>, <time datetime="2020-04-20">20 April 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-capport-architecture-07.txt">http://www.ietf.org/internet-drafts/draft-ietf-capport-architecture-07.txt</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2132">[RFC2132]</dt>
<dd>
<span class="refAuthor">Alexander, S.</span><span class="refAuthor"> and R. Droms</span>, <span class="refTitle">"DHCP Options and BOOTP Vendor Extensions"</span>, <span class="seriesInfo">RFC 2132</span>, <span class="seriesInfo">DOI 10.17487/RFC2132</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2132">https://www.rfc-editor.org/info/rfc2132</a>&gt;</span>. </dd>
<dt id="RFC8106">[RFC8106]</dt>
<dd>
<span class="refAuthor">Jeong, J.</span><span class="refAuthor">, Park, S.</span><span class="refAuthor">, Beloeil, L.</span><span class="refAuthor">, and S. Madanapalli</span>, <span class="refTitle">"IPv6 Router Advertisement Options for DNS Configuration"</span>, <span class="seriesInfo">RFC 8106</span>, <span class="seriesInfo">DOI 10.17487/RFC8106</span>, <time datetime="2017-03">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8106">https://www.rfc-editor.org/info/rfc8106</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tommy Pauly</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">One Apple Park Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cupertino, California 95014</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tpauly@apple.com" class="email">tpauly@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Kinnear</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">One Apple Park Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cupertino, California 95014</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ekinnear@apple.com" class="email">ekinnear@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Patrick McManus</span></div>
<div dir="auto" class="left"><span class="org">Fastly</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcmanus@ducksong.com" class="email">mcmanus@ducksong.com</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
